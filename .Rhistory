eval(parse("helperFunctions.r"))
df.ed <- read.csv("gni&enrolment.csv")  # read a csv file. in excel save as .csv
View(df.ed)
labels <- df.ed[[1]]
row.names(df.ed) <- labels
df.ed$X <- NULL  # remove column with country name
df.edgni <- data.frame(normalize(df.ed$enrolment),normalize(df.ed$gni.cap))
row.names(df.edgni) <- labels
nbclust(df.edgni)
d <- dist(df.edgni, method = "euclidean")
ed.cluster <- hclust(d, "ward.D2")
groups <- cutree(ed.cluster, 4)
palette(value = c('red', 'blue', 'green', 'black', 'yellow'))
plot(df.edgni, col = as.factor(groups))
text(df.edgni, labels = row.names(df.edgni),cex=0.7, pos=3)  # create labels
df.ed <- df.ed[-22]
df.edgni <- data.frame(normalize(df.ed$enrolment), normalize(df.ed$gni.cap))
df.edClean <- df.ed[-22]
rm(df.edgni)
df.edgni <- data.frame(normalize(df.edClean$enrolment), normalize(df.edClean$gni.cap))
nbclust(df.edgni)
d <- dist(df.edgni, method = "euclidean")
ed.cluster <- hclust(d, "ward.D2")
groups <- cutree(ed.cluster, 4)
palette(value = c('red', 'blue', 'green', 'black', 'yellow'))
plot(df.edgni, col = as.factor(groups))
text(df.edgni, labels = row.names(df.edgni),cex=0.7, pos=3)  # create labels
View(df.edClean)
row.names(df.edgni) <- labels
nbclust(df.edgni)
d <- dist(df.edgni, method = "euclidean")
ed.cluster <- hclust(d, "ward.D2")
groups <- cutree(ed.cluster, 4)
palette(value = c('red', 'blue', 'green', 'black', 'yellow'))
plot(df.edgni, col = as.factor(groups))
text(df.edgni, labels = row.names(df.edgniClean),cex=0.7, pos=3)  # create labels
text(df.edgni, labels = row.names(df.edgni),cex=0.7, pos=3)  # create labels
View(df.edClean)
df.ed[-22]
df.ed[-23]
df.ed[-24]
df.ed[-22]
df.ed[22]
df.ed[1]
df.ed[22,]
df.ed[-22,]
df.edClean <- df.ed[-22,]
rm(df.edgni)
View(df.edClean)
df.edgni <- data.frame(normalize(df.edClean$enrolment), normalize(df.edClean$gni.cap))
row.names(df.edgni) <- labels
nbclust(df.edgni)
d <- dist(df.edgni, method = "euclidean")
ed.cluster <- hclust(d, "ward.D2")
groups <- cutree(ed.cluster, 4)
palette(value = c('red', 'blue', 'green', 'black', 'yellow'))
plot(df.edgni, col = as.factor(groups))
text(df.edgni, labels = row.names(df.edgni),cex=0.7, pos=3)  # create labels
row.names(df.edgni) <- df.ed[[1]]
nbclust(df.edgni)
d <- dist(df.edgni, method = "euclidean")
ed.cluster <- hclust(d, "ward.D2")
groups <- cutree(ed.cluster, 4)
palette(value = c('red', 'blue', 'green', 'black', 'yellow'))
plot(df.edgni, col = as.factor(groups))
text(df.edgni, labels = row.names(df.edgni),cex=0.7, pos=3)  # create labels
row.names(df.edgni) <- df.edClean[[1]]
nbclust(df.edgni)
d <- dist(df.edgni, method = "euclidean")
ed.cluster <- hclust(d, "ward.D2")
groups <- cutree(ed.cluster, 4)
palette(value = c('red', 'blue', 'green', 'black', 'yellow'))
plot(df.edgni, col = as.factor(groups))
text(df.edgni, labels = row.names(df.edgni),cex=0.7, pos=3)  # create labels
View(df.edClean)
df.edClean.labels
df.edClean.row.names
row.names(df.edClean)
d <- dist(df.edgni, method = "euclidean")
ed.cluster <- hclust(d, "ward.D2")
groups <- cutree(ed.cluster, 4)
palette(value = c('red', 'blue', 'green', 'black', 'yellow'))
plot(df.edgni, col = as.factor(groups))
text(df.edgni, labels = row.names(df.edgni),cex=0.7, pos=3)  # create labels
df.edClean <- df.ed[-22,]
rm(df.edgni)
row.names(df.edgni) <- row.names(df.edClean)
nbclust(df.edgni)
df.edgni <- data.frame(normalize(df.edClean$enrolment), normalize(df.edClean$gni.cap))
d <- dist(df.edgni, method = "euclidean")
groups <- cutree(ed.cluster, 4)
ed.cluster <- hclust(d, "ward.D2")
palette(value = c('red', 'blue', 'green', 'black', 'yellow'))
plot(df.edgni, col = as.factor(groups))
text(df.edgni, labels = row.names(df.edgni),cex=0.7, pos=3)  # create labels
df.edClean <- df.ed[-22,]
eval(parse("helperFunctions.r"))
df.ed <- read.csv("gni&enrolment.csv")  # read a csv file. in excel save as .csv
# df.ed type is now a 'dataframe': R specific datatype.
# It's essentially a data table
# make country name the row labels in the dataframe instead of numbers
labels <- df.ed[[1]]
row.names(df.ed) <- labels
df.ed$X <- NULL  # remove column with country name
# Now column 1 is enrolment and col 2 gni
# this is how you create a new dataframe
df.edgni <- data.frame(normalize(df.ed$enrolment),normalize(df.ed$gni.cap))
row.names(df.edgni) <- labels
#evaluate clustering
nbclust(df.edgni)
# hierarchical clustering
d <- dist(df.edgni, method = "euclidean")
ed.cluster <- hclust(d, "ward.D2")
groups <- cutree(ed.cluster, 4)
# plot clustering
palette(value = c('red', 'blue', 'green', 'black', 'yellow'))
plot(df.edgni, col = as.factor(groups))
text(df.edgni, labels = row.names(df.edgni),cex=0.7, pos=3)  # create labels
df.edClean <- df.ed[-22,]
rm(df.edgni)
View(df.edClean)
df.edgni <- data.frame(normalize(df.edClean$enrolment), normalize(df.edClean$gni.cap))
row.names(df.edgni) <- row.names(df.edClean)
View(df.edgni)
nbclust(df.edgni)
d <- dist(df.edgni, method = "euclidean")
ed.cluster <- hclust(d, "ward.D2")
groups <- cutree(ed.cluster, 4)
palette(value = c('red', 'blue', 'green', 'black', 'yellow'))
plot(df.edgni, col = as.factor(groups))
text(df.edgni, labels = row.names(df.edgni),cex=0.7, pos=3)  # create labels
groups <- cutree(ed.cluster, 3)
palette(value = c('red', 'blue', 'green', 'black', 'yellow'))
plot(df.edgni, col = as.factor(groups))
text(df.edgni, labels = row.names(df.edgni),cex=0.7, pos=3)  # create labels
title(main = "College Enrolment and National Income Per Capita", xlab = 'GNI per capita', "College enrolment")
title(main = "College Enrolment and National Income Per Capita", xlab = 'GNI per capita', ylab = "College enrolment")
palette(value = c('red', 'blue', 'green', 'black', 'yellow'))
plot(df.edgni, col = as.factor(groups))
text(df.edgni, labels = row.names(df.edgni),cex=0.7, pos=3)  # create labels
title(main = "College Enrolment and National Income Per Capita", xlab = 'GNI per capita', ylab = "College enrolment")
palette(value = c('red', 'blue', 'green', 'black', 'yellow'))
plot(df.edgni, col = as.factor(groups))
text(df.edgni, labels = row.names(df.edgni),cex=0.7, pos=3)  # create labels
title(main = "College Enrolment and National Income Per Capita", xlab = 'GNI per capita', ylab = "College enrolment")
title(main = "College Enrolment and National Income Per Capita", xlab = '', ylab = "")
text(df.edgni, labels = row.names(df.edgni),cex=0.7, pos=3)  # create labels
title(main = "College Enrolment and National Income Per Capita", xlab = '', ylab = "")
palette(value = c('red', 'blue', 'green', 'black', 'yellow'))
plot(df.edgni, col = as.factor(groups))
text(df.edgni, labels = row.names(df.edgni),cex=0.7, pos=3)  # create labels
title(main = "College Enrolment and National Income Per Capita", xlab = '', ylab = "")
# plot clustering
palette(value = c('red', 'blue', 'green', 'black', 'yellow'))
plot(df.edgni, col = as.factor(groups))
text(df.edgni, labels = row.names(df.edgni),cex=0.7, pos=3)  # create labels
title(main = "College Enrolment and National Income Per Capita")
eval(parse("helperFunctions.r"))
source <- read.csv("Workers_Fatality_VS_GDP.csv")
labels <- source[[1]]
df.fatal <- data.frame(normalize(source$Workers_Fatality_per_100000_per_year),
normalize(sqrt(source$GDP_per_cap)))
source <- data.frame(source$Workers_Fatality_per_100000_per_year,
source$GDP_per_cap)
row.names(source) <- labels
row.names(df.fatal) <- labels
# hierarchical clustering
d <- dist(df.fatal, method = "maximum")
clust <- hclust(d, "ward.D2")
groups <- cutree(clust, 4)
# plot clustering
palette(value = c('red', 'blue', 'green', 'black'))
plot(df.fatal, col = as.factor(groups))
text(df.fatal, labels = row.names(df.fatal),cex=0.7, pos=3)  # create labels
title(main = "Worker Fatality per 100000/year and GDP per Capita")
eval(parse("helperFunctions.r"))
source <- read.csv("Workers_Fatality_VS_GDP.csv")
labels <- source[[1]]
df.fatal <- data.frame(normalize(source$Workers_Fatality_per_100000_per_year),
normalize(sqrt(source$GDP_per_cap)))
source <- data.frame(source$Workers_Fatality_per_100000_per_year,
source$GDP_per_cap)
row.names(source) <- labels
row.names(df.fatal) <- labels
# hierarchical clustering
d <- dist(df.fatal, method = "maximum")
clust <- hclust(d, "ward.D2")
groups <- cutree(clust, 4)
# plot clustering
palette(value = c('red', 'blue', 'green', 'black'))
plot(df.fatal, col = as.factor(groups))
text(df.fatal, labels = row.names(df.fatal),cex=0.7, pos=3)  # create labels
title(main = "Worker Fatality per 100000/year and GDP per Capita")
# plot clustering
palette(value = c('red', 'blue', 'green', 'black', 'yellow'))
plot(df.edgni, col = as.factor(groups))
text(df.edgni, labels = row.names(df.edgni),cex=0.7, pos=3)  # create labels
title(main = "College Enrolment and National Income Per Capita")
# code was written as guide for non-technical colleagues
#
# 1. sets up R environment for cluster analysis
# 2. calculates clustering for education and GNI
# step 1: change working directory to folder with data files/code
getwd()  # current directory
# setwd("directory")  change directory
eval(parse("helperFunctions.r"))
df.ed <- read.csv("gni&enrolment.csv")  # read a csv file. in excel save as .csv
# df.ed type is now a 'dataframe': R specific datatype.
# It's essentially a data table
# make country name the row labels in the dataframe instead of numbers
labels <- df.ed[[1]]
row.names(df.ed) <- labels
df.ed$X <- NULL  # remove column with country name
# Now column 1 is enrolment and col 2 gni
# this is how you create a new dataframe
df.edgni <- data.frame(normalize(df.ed$enrolment),normalize(df.ed$gni.cap))
row.names(df.edgni) <- labels
#evaluate clustering
nbclust(df.edgni)
# hierarchical clustering
d <- dist(df.edgni, method = "euclidean")
ed.cluster <- hclust(d, "ward.D2")
clusters <- cutree(ed.cluster, 4)
# plot clustering
palette(value = c('red', 'blue', 'green', 'black', 'yellow'))
plot(df.edgni, col = as.factor(clusters))
text(df.edgni, labels = row.names(df.edgni),cex=0.7, pos=3)  # create labels
#looks like Macao SAR, China is an outlier
df.edClean <- df.ed[-22,]
rm(df.edgni)
#rerun clustering
#normalize data
df.edgni <- data.frame(normalize(df.edClean$enrolment), normalize(df.edClean$gni.cap))
row.names(df.edgni) <- row.names(df.edClean)
#evaluate clustering
nbclust(df.edgni)
# hierarchical clustering
d <- dist(df.edgni, method = "euclidean")
ed.cluster <- hclust(d, "ward.D2")
clusters <- cutree(ed.cluster, 3)
# plot clustering
palette(value = c('red', 'blue', 'green', 'black', 'yellow'))
plot(df.edgni, col = as.factor(clusters))
text(df.edgni, labels = row.names(df.edgni),cex=0.7, pos=3)  # create labels
title(main = "College Enrolment and National Income Per Capita")
